# فیلتر گروه‌ها - فقط پردازش گروه‌ها

## خلاصه
این ویژگی جدید به سیستم اضافه شده است تا فقط گروه‌ها (Groups و Supergroups) پردازش شوند و کانال‌ها (Channels) و سایر انواع چت‌ها رد شوند. **اطلاعات کانال‌ها در دیتابیس ذخیره می‌شود اما کاربران از آنها استخراج نمی‌شود.**

## تغییرات اعمال شده

### 1. تشخیص نوع چت
سیستم حالا نوع چت را تشخیص می‌دهد:
- **GROUP**: گروه‌های عادی
- **SUPERGROUP**: سوپرگروه‌ها  
- **CHANNEL**: کانال‌ها
- **PRIVATE**: چت‌های خصوصی

### 2. فیلتر کردن
- ✅ **پردازش می‌شوند**: GROUP و SUPERGROUP (پیام‌ها و کاربران استخراج می‌شود)
- 📢 **ذخیره در دیتابیس**: CHANNEL (فقط اطلاعات کانال ذخیره می‌شود)
- 📝 **ذخیره در دیتابیس**: سایر انواع چت (فقط اطلاعات چت ذخیره می‌شود)

### 3. آمار جدید
سیستم حالا آمار دقیق‌تری ارائه می‌دهد:
```
📊 Analysis Summary:
   ✅ Successfully processed: 5 groups
   📢 Channels saved to DB: 3
   📝 Other chats saved to DB: 1
   ⏭️ Total skipped: 4
   ❌ Failed: 1
   📋 Total links: 9
```

## نحوه استفاده

### اجرای عادی
```bash
cd analyzer
python main.py
```

### تست تشخیص نوع چت
```bash
cd analyzer
python test_group_filter.py
```

## فایل‌های تغییر یافته

### 1. `main.py`
- اضافه شدن بررسی نوع چت در `analyze_single_chat()`
- ذخیره اطلاعات کانال‌ها در دیتابیس
- اضافه شدن آمار saved channels
- بهبود گزارش‌گیری

### 2. `models/data_models.py`
- اضافه شدن `SKIPPED` به `ScanStatus`

### 3. `test_group_filter.py` (جدید)
- فایل تست برای بررسی تشخیص نوع چت

## نمونه خروجی

### برای گروه‌ها:
```
✅ Processing group: R6Fan | GP (Type: supergroup)
📊 Chat Info: R6Fan | GP (9449 members)
📝 Processing 50 messages...
👥 Processing 100 members...
✅ Group info saved to MongoDB: -1001414309552
```

### برای کانال‌ها:
```
⚠️ Skipping channel: ProLoader Channel ™ (ID: -1001767921528)
   📢 Channel type detected - only groups are processed
✅ Channel info saved to MongoDB: -1001767921528
```

## مزایا

1. **صرفه‌جویی در زمان**: فقط گروه‌ها پردازش می‌شوند
2. **دقت بیشتر**: کاربران فقط از گروه‌ها استخراج می‌شوند
3. **ذخیره اطلاعات کامل**: اطلاعات کانال‌ها در دیتابیس ذخیره می‌شود
4. **گزارش بهتر**: آمار دقیق از پردازش شده‌ها و ذخیره شده‌ها
5. **قابلیت تست**: امکان تست تشخیص نوع چت

## تنظیمات

در حال حاضر فیلتر گروه‌ها فعال است و قابل تغییر نیست. در صورت نیاز به تغییر، می‌توانید در فایل `main.py` در تابع `analyze_single_chat()` تغییرات لازم را اعمال کنید.

## نکات مهم

- کانال‌ها به طور کامل رد می‌شوند و هیچ اطلاعاتی از آنها استخراج نمی‌شود
- فقط گروه‌ها و سوپرگروه‌ها پردازش می‌شوند
- اطلاعات کانال‌ها در دیتابیس ذخیره می‌شود
- آمار دقیق از تعداد رد شده‌ها در گزارش نهایی نمایش داده می‌شود 